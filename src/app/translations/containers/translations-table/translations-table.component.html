
<nz-table #translationsTable nzBordered [nzData]="translations" nzSize="small">
  <thead>
    <tr>
      <th nzWidth="32px"></th>
      <th nzWidth="25%">Key</th>
      <th nzWidth="20%">Source (<b>{{ sourceLanguage }}</b>)</th>
      <th>Target (<b>{{ targetLanguage }}</b>)</th>
      <th nzWidth="90px"></th>
    </tr>
  </thead>
  <tbody>
    <ng-container *ngFor="let data of translationsTable.data; let i = index">
      <tr [ngClass]="{ 'invalid-row': invalidTranslationsMap[data.translationId]}">
        <td>
          <i *ngIf="!missingTranslationsMap[data.translationId] && !invalidTranslationsMap[data.translationId]" style="color: rgb(82, 196, 26)" nz-icon nzType="check-circle" nzTheme="outline"></i>
          <i *ngIf="missingTranslationsMap[data.translationId]" style="color: rgba(0, 0, 0, 0.65);" nz-icon nzType="ellipsis" nzTheme="outline"></i>
          <i *ngIf="invalidTranslationsMap[data.translationId]" style="color: red" nz-icon nzType="exclamation-circle" nzTheme="outline"></i>
        </td>
        <td>
          <span style="max-width: 100px">{{ data.translationId.length > 28 ? (data.translationId | slice:0:28) + '...' : data.translationId }}</span>
        </td>
        <td>
          <ng-container>
            <app-taal-editor
              [readonly]="true"
              (taalEditorChange)="taalEditorChange($event)"
              [index]="i"
              [parts]="data.parts"
              [icuExpressions]="data.icuExpressions"></app-taal-editor>
          </ng-container>
        </td>
        <td>
          <app-taal-editor
            (click)="startEdit(i)"
            (taalEditorChange)="taalEditorChange($event)"              
            [index]="i"
            [parts]="data.targetParts"
            [action$]="taalEditorActionDispatcher.asObservable()"
            [icuExpressions]="data.icuExpressions"></app-taal-editor>
        </td>
        <td>
          <button
            style="display: inline-block;"
            nz-button
            nzType="primary"
            nzGhost
            [disabled]="!editCache[i].edit"
            (click)="saveEdit(i)"><i nz-icon type="check"></i></button>
            <button
            style="display: inline-block; margin-left: 8px;"
            nz-button
            nzType="danger"
            nzGhost
            [disabled]="!editCache[i].edit"
            (click)="undoEdit(i)"><i nz-icon type="undo"></i></button>
        </td>
      </tr>
      <tr *ngIf="editCache[i].missingPlaceholders?.length || editCache[i].missingICUExpressions?.length" [nzExpand]="mapOfExpandData[i]">
        <td></td>
        <td></td>
        <td></td>
        <td>
          <div *ngIf="editCache[i].missingPlaceholders?.length">
            Missing Placeholders: <span class="placeholder" (click)="addPlaceholder(item, i)" *ngFor="let item of editCache[i].missingPlaceholders">{{ item.meta }}</span>
          </div>
          <div *ngIf="editCache[i].missingICUExpressions?.length">
            Missing ICU Expressions: <span class="placeholder" (click)="addICUExpression(item, i)" *ngFor="let item of editCache[i].missingICUExpressions">ICU Expression</span>
          </div>
        </td>
        <td></td>
      </tr>
    </ng-container>
  </tbody>
</nz-table>